<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<link rel="stylesheet" href="styles.css" type="text/css">
<title>svm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="nav.js"></script>

<script src="SVM_files/libs/clipboard/clipboard.min.js"></script>
<script src="SVM_files/libs/quarto-html/quarto.js"></script>
<script src="SVM_files/libs/quarto-html/popper.min.js"></script>
<script src="SVM_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SVM_files/libs/quarto-html/anchor.min.js"></script>
<link href="SVM_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SVM_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SVM_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SVM_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SVM_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-support-vector-machinesvm" id="toc-introduction-to-support-vector-machinesvm" class="nav-link active" data-scroll-target="#introduction-to-support-vector-machinesvm">01. Introduction to Support Vector Machine(SVM)</a></li>
  <li><a href="#data-pre-processing" id="toc-data-pre-processing" class="nav-link" data-scroll-target="#data-pre-processing">02. Data pre-processing</a></li>
  <li><a href="#distribution-of-class-labels" id="toc-distribution-of-class-labels" class="nav-link" data-scroll-target="#distribution-of-class-labels">03. Distribution of Class labels</a></li>
  <li><a href="#baseline-model-for-comparison" id="toc-baseline-model-for-comparison" class="nav-link" data-scroll-target="#baseline-model-for-comparison">04. Baseline model for comparison</a></li>
  <li><a href="#data-modelling-svm-classification" id="toc-data-modelling-svm-classification" class="nav-link" data-scroll-target="#data-modelling-svm-classification">05. Data Modelling (SVM Classification)</a></li>
  <li><a href="#hyperparameter-optimization-model-tuning" id="toc-hyperparameter-optimization-model-tuning" class="nav-link" data-scroll-target="#hyperparameter-optimization-model-tuning">06.Hyperparameter Optimization (Model tuning)</a></li>
  <li><a href="#optimal-model" id="toc-optimal-model" class="nav-link" data-scroll-target="#optimal-model">07. Optimal Model</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">08. Conclusion</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">



<section id="introduction-to-support-vector-machinesvm" class="level1">
<h1>01. Introduction to Support Vector Machine(SVM)</h1>
<p>A SVM is a supervised machine learning algorithm used for both classification and regression.we will focus on the classification in this section. The objective of SVM algorithms is to detect a hyperplane that distinguishes between classes in an N-dimensional space. Hyperplane dimensions are determined by the number of features. When there are just two input features, the hyperplane is just a line. Hyperplanes become 2-D planes if there are three input features. As the number of features increases, it becomes more difficult to imagine.</p>
<p>In this section, we will use SVM to classify the input text and determine the tone of each input text. The data set we are going to use consists of 2500 tweets that contain the word that relate to the word “weed”, “cannabins” and “Marijuana” ect.. and tone which represents the sentiments of each tweet.</p>
<p>We will go through the 7 steps and I will write description for each step. In the end, we will get a SVM model that can help us to classify the sentiments of the input text. Therefore, based on the sentiments we can know if the people like Marijuana or not.</p>
</section>
<section id="data-pre-processing" class="level1">
<h1>02. Data pre-processing</h1>
<p>It is an essential step in any data mining process. Basically, it involves transforming raw data into a format that can be understood by NLP models. Real-world data is sometimes inaccurate and&nbsp;it is also frequently inconsistent and incomplete. Pre processing data is a good way to solve these issues. This will help in getting better results through the classification algorithms.</p>
<li>
Data Cleaning
</li>
<p>By removing the blank rows in data and changing all the text to lower case. typecast some data into desired type, unify data format, remove some unrealistic number (e.g.&nbsp;negative number in the age column), remove outliers etc.</p>
<p>All of above process can be applied on the text/numeric input data and those will help us improve the result of classification.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#import packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_recall_fscore_support,classification_report,confusion_matrix, ConfusionMatrixDisplay</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.tokenize <span class="im">import</span> word_tokenize      </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer        </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> make_pipeline</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> TfidfVectorizer</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> TextFeatureSelection <span class="im">import</span> TextFeatureSelection</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read file,drop dummy column and label the tone -1,0,1 where -1: neg, 0:neu, 1: pos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">'../clean_tweet_tone_df.csv'</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.drop(<span class="st">'Unnamed: 0'</span>,axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>text<span class="op">=</span>df[{<span class="st">'clean_text'</span>,<span class="st">'tone'</span>}]</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>text[<span class="st">'tone'</span>]<span class="op">=</span>text[<span class="st">'tone'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="dv">0</span> <span class="cf">if</span> x <span class="op">==</span> <span class="dv">0</span> <span class="cf">else</span> (<span class="dv">1</span> <span class="cf">if</span> x<span class="op">&gt;</span><span class="dv">0</span> <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span>) )</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>clean_text</th>
      <th>tone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>medical pain taxes spent putting people jail s...</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>good way clean follower list app called see fo...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>legalize marijuana remove barriers desantis p...</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rt chem d ig</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>weed bro thats straight losses miami pats lon...</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>caught someone smoking weed pen class hahahaha...</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>research shows black brown people disproporti...</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>smoke weed responsible mentally sick sober ser...</td>
      <td>-1</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>people call weed cannabis</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>coughing hit weed ive never seen feel free</td>
      <td>-1</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 2 columns</p>
</div>
</div>
</div>
<p>The graph above is the input text data. Each line represents a sentence and we have 2500 sentence as input text. Also, we have labelled the tone of each text. -1 represents negatives ;0 represents neutrals ;1 represents positives. Here is the count of each type of tone</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count each type of tone</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>text[<span class="st">'tone'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code> 1    1056
 0     746
-1     698
Name: tone, dtype: int64</code></pre>
</div>
</div>
<li>
Word Tokenization
</li>
<p>This is a process of breaking a text into words, phrases, symbols, or other meaningful elements called tokens. The list of tokens as input can be “read” by the machine. We will use the NLTK Library which has word_tokenize to easily break the input text into word list.</p>
<li>
Word Stemming/Lemmatization
</li>
<p>Stemming is a process that stems or removes last few characters from a word, often leading to incorrect meanings and spelling. Lemmatization considers the context and converts the word to its meaningful base form</p>
<p>For more details and codes, click the ‘Data Cleaning’ tab.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tokenize the text</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>text[<span class="st">'word_tokenize'</span>]<span class="op">=</span> [word_tokenize(entry) <span class="cf">for</span> entry <span class="kw">in</span> text[<span class="st">'clean_text'</span>]]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>text</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>clean_text</th>
      <th>tone</th>
      <th>word_tokenize</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>medical pain taxes spent putting people jail s...</td>
      <td>-1</td>
      <td>[medical, pain, taxes, spent, putting, people,...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>good way clean follower list app called see fo...</td>
      <td>1</td>
      <td>[good, way, clean, follower, list, app, called...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>legalize marijuana remove barriers desantis p...</td>
      <td>-1</td>
      <td>[legalize, marijuana, remove, barriers, desant...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>rt chem d ig</td>
      <td>0</td>
      <td>[rt, chem, d, ig]</td>
    </tr>
    <tr>
      <th>4</th>
      <td>weed bro thats straight losses miami pats lon...</td>
      <td>-1</td>
      <td>[weed, bro, thats, straight, losses, miami, pa...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>caught someone smoking weed pen class hahahaha...</td>
      <td>1</td>
      <td>[caught, someone, smoking, weed, pen, class, h...</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>research shows black brown people disproporti...</td>
      <td>0</td>
      <td>[research, shows, black, brown, people, dispro...</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>smoke weed responsible mentally sick sober ser...</td>
      <td>-1</td>
      <td>[smoke, weed, responsible, mentally, sick, sob...</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>people call weed cannabis</td>
      <td>0</td>
      <td>[people, call, weed, cannabis]</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>coughing hit weed ive never seen feel free</td>
      <td>-1</td>
      <td>[coughing, hit, weed, ive, never, seen, feel, ...</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 3 columns</p>
</div>
</div>
</div>
<p>the table above, we added a column called word_tokenize and put the tokenized text in the column.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#lemmanize the text</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.stem <span class="im">import</span> WordNetLemmatizer</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>lemmatizer <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>test<span class="op">=</span>[lemmatizer.lemmatize(w) <span class="cf">for</span> w <span class="kw">in</span> text[<span class="st">'word_tokenize'</span>][<span class="dv">0</span>]]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>test</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>['medical',
 'pain',
 'tax',
 'spent',
 'putting',
 'people',
 'jail',
 'sin',
 'big',
 'pharma',
 'fear',
 'legal',
 'marijuana',
 'amp',
 'terrorism',
 'victim',
 'blocked',
 'u',
 'gover',
 'via']</code></pre>
</div>
</div>
<p>The word list above is the first input text after lemmatization. I will apply the lemmatization to all the input text later.</p>
<li>
Text Vectorization
</li>
<p>Text Vectorization is the process of converting text into numerical representation. Here we are going to use Count Vectorizer from NLTK library to vectorize the text. It is used to transform a given text into a vector on the basis of the frequency (count) of each word that occurs in the entire text.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vectorizer Counter</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> LemmaTokenizer(<span class="bu">object</span>):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.wnl <span class="op">=</span> WordNetLemmatizer()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__call__</span>(<span class="va">self</span>, articles):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [<span class="va">self</span>.wnl.lemmatize(t) <span class="cf">for</span> t <span class="kw">in</span> word_tokenize(articles)]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>corpus<span class="op">=</span>df[<span class="st">'clean_text'</span>]</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>vectorizer <span class="op">=</span> CountVectorizer(stop_words<span class="op">=</span><span class="st">'english'</span> ,lowercase<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> vectorizer.fit_transform(corpus)</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(vectorizer.get_feature_names_out()[:<span class="dv">50</span>])</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.toarray()[:<span class="dv">20</span>])</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"the shape of the matrix is "</span>,X.toarray().shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>['aahn' 'aaron' 'ab' 'abc' 'ability' 'able' 'abolished' 'abolitionism'
 'abortion' 'abortions' 'abroad' 'absolute' 'absolutely' 'abt' 'abundance'
 'abuse' 'abusers' 'accept' 'acceptable' 'accepted' 'accepts' 'access'
 'accessory' 'accident' 'accomplished' 'according' 'account' 'accountant'
 'accounts' 'accretive' 'accumulate' 'accurately' 'accustomed' 'ace'
 'achieved' 'achievement' 'achievements' 'acid' 'acquiring' 'acquisition'
 'acre' 'acres' 'acro' 'act' 'acted' 'acting' 'action' 'actions' 'active'
 'activist']
[[0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 ...
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]
 [0 0 0 ... 0 0 0]]
the shape of the matrix is  (2500, 6345)</code></pre>
</div>
</div>
<li>
Feature Selection
</li>
<p>we will use text feature selection from TextFeatureSelection library to help us choosing correct feature as input. It will reduce the dimensions of out input data so data complexity is reduced as well, so we can get better result.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the features</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> SelectKBest</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_selection <span class="im">import</span> chi2</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> SelectKBest(chi2, k<span class="op">=</span><span class="dv">5100</span>).fit_transform(X, text[<span class="st">'tone'</span>])</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>X.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>(2500, 5100)</code></pre>
</div>
</div>
<p>the size of our data becomes 2500 x 5100 and removes around 20% features (columns)</p>
<li>
Split Data
</li>
<p>We split the dataset into two parts. One part is used for train the model and another part is used for testing the model performance.</p>
<p>We are performing a train test split on our dataset. We are providing the test size as 0.20, that means our training sample contains 2000 training set and test sample contains 500 test set.</p>
<p>The word list represent all words from input text (only show first 20 words) and the matrix below is the count of word for each input text.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#split the data into training set and test set</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>x_train,x_test,y_train,y_test<span class="op">=</span>train_test_split(X,text[<span class="st">'tone'</span>],test_size<span class="op">=</span><span class="fl">0.2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"X_train.shape"</span>,x_train.shape)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"y_train.shape"</span>,y_train.shape)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"X_test.shape"</span>,x_test.shape)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"y_test.shape"</span>,y_test.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>X_train.shape (2000, 5100)
y_train.shape (2000,)
X_test.shape (500, 5100)
y_test.shape (500,)</code></pre>
</div>
</div>
</section>
<section id="distribution-of-class-labels" class="level1">
<h1>03. Distribution of Class labels</h1>
<p>Plotting the distribution of the class labels will help use to determine which kernel that we can use for the SVM model also what effect it might have on the classification algorithm results.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#distribution of tone </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>plt.hist(text[<span class="st">'tone'</span>])</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"distribution of class labels"</span>,fontsize<span class="op">=</span><span class="dv">18</span>)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"labels"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"count"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Text(0, 0.5, 'count')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-10-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>It seems like the number of label “-1” and label “0” are less than label “1” and label “1” has the most large sample size. So, I think the result of label “1” will have highest accuracy due to the large sample size. And label “-1” and label “0” will have similar accuracy since they have similar sample size.</p>
</section>
<section id="baseline-model-for-comparison" class="level1">
<h1>04. Baseline model for comparison</h1>
<p>In this part. We will define a classification method called “random classifier” that randomly chooses the label between the classes and we will use the random selection as our predicted labels. So, the random classifier will give us the worse case for the given classification problem and we can use the result from the random classifier to compare the result from SVM model we are going to use later.</p>
<p>Since we just do the random selection so how well the random classifier does depends on the number of classes, and the load balance between classes.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> random_classifier(y_data):</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>    ypred<span class="op">=</span>[]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>    max_label<span class="op">=</span>np.<span class="bu">max</span>(y_data)<span class="op">;</span> <span class="co">#print(max_label)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(y_data)):</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        ypred.append(random.choice(y_data))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"-----RANDOM CLASSIFIER-----"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"count of prediction:"</span>,Counter(ypred).values()) <span class="co"># counts the elements' frequency</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"probability of prediction:"</span>,np.fromiter(Counter(ypred).values(), dtype<span class="op">=</span><span class="bu">float</span>)<span class="op">/</span><span class="bu">len</span>(y_data)) <span class="co"># counts the elements' frequency</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"accuracy"</span>,accuracy_score(y_data, ypred))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"percision, recall, fscore,"</span>,precision_recall_fscore_support(y_data, ypred))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>random_classifier(text[<span class="st">'tone'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>-----RANDOM CLASSIFIER-----
count of prediction: dict_values([1032, 752, 716])
probability of prediction: [0.4128 0.3008 0.2864]
accuracy 0.3372
percision, recall, fscore, (array([0.27094972, 0.30053191, 0.40988372]), array([0.27793696, 0.30294906, 0.40056818]), array([0.27439887, 0.30173565, 0.40517241]), array([ 698,  746, 1056]))</code></pre>
</div>
</div>
<p>Therefore, we can use the information above to compare the SVM model to see if the SVM will improve any.</p>
</section>
<section id="data-modelling-svm-classification" class="level1">
<h1>05. Data Modelling (SVM Classification)</h1>
<p>Now we can use our training set to train the model and use test set to see the performance.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#train the model</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="dv">4</span>,kernel<span class="op">=</span><span class="st">"linear"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>clf.fit(x_train,y_train)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co">#predict the </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(x_train)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(x_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get confusion matrix</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>con_mat_train <span class="op">=</span> confusion_matrix(y_train,yp_train,labels<span class="op">=</span>clf.classes_)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>con_mat_test <span class="op">=</span> confusion_matrix(y_test,yp_test,labels<span class="op">=</span>clf.classes_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The table below is classification report for the train data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>df_result <span class="op">=</span> classification_report(y_train,yp_train,output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df_result <span class="op">=</span>pd.DataFrame(df_result).T</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="102">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>1.000000</td>
      <td>0.996546</td>
      <td>0.998270</td>
      <td>579.000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.994941</td>
      <td>1.000000</td>
      <td>0.997464</td>
      <td>590.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.998795</td>
      <td>0.997593</td>
      <td>0.998194</td>
      <td>831.000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.998000</td>
      <td>0.998000</td>
      <td>0.998000</td>
      <td>0.998</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.997912</td>
      <td>0.998046</td>
      <td>0.997976</td>
      <td>2000.000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.998007</td>
      <td>0.998000</td>
      <td>0.998001</td>
      <td>2000.000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>The table below is classification report for the test data</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df_result <span class="op">=</span> classification_report(y_test,yp_test,output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>df_result <span class="op">=</span>pd.DataFrame(df_result).T</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="103">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>precision</th>
      <th>recall</th>
      <th>f1-score</th>
      <th>support</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>-1</th>
      <td>0.728155</td>
      <td>0.630252</td>
      <td>0.675676</td>
      <td>119.000</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.677725</td>
      <td>0.916667</td>
      <td>0.779292</td>
      <td>156.000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.887097</td>
      <td>0.733333</td>
      <td>0.802920</td>
      <td>225.000</td>
    </tr>
    <tr>
      <th>accuracy</th>
      <td>0.766000</td>
      <td>0.766000</td>
      <td>0.766000</td>
      <td>0.766</td>
    </tr>
    <tr>
      <th>macro avg</th>
      <td>0.764326</td>
      <td>0.760084</td>
      <td>0.752629</td>
      <td>500.000</td>
    </tr>
    <tr>
      <th>weighted avg</th>
      <td>0.783945</td>
      <td>0.766000</td>
      <td>0.765264</td>
      <td>500.000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Here we get confusion matrix</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>con_mat_test,</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                            display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>disp.plot()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"confusion matrix for test data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>Text(0.5, 1.0, 'confusion matrix for test data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-16-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>As we can see, the precision is very high for the both train data and test data. Also, we can calculate the accuracy of our model from confusion matrix which is <span class="math inline">\(\dfrac{75+143+165}{500} =0.766\)</span>. The accuracy is so mush higher than the one we got from random classifier. So, the SVM model can actually predicts the sentiments for input text.</p>
</section>
<section id="hyperparameter-optimization-model-tuning" class="level1">
<h1>06.Hyperparameter Optimization (Model tuning)</h1>
<p>In training, hyperparameters are variables that control the process. During a Model training job, these configuration variables do not change. You can maximize its predictive accuracy by selecting optimized values for hyperparameter.</p>
<p>In this part, we will choose different values for the hyperparameters (C in SVM model)) and run the model with the chosen C then save its accuracy. Finally, plot the accuracy vs hyperparameter’s value to find out the optimal model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> accuracy_score </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> precision_score </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> recall_score</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>test_results<span class="op">=</span>[]</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>train_results<span class="op">=</span>[]</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Hyperparameter Tuning</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> np.linspace(<span class="fl">0.1</span>,<span class="dv">10</span>,<span class="dv">30</span>):</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> SVC(C<span class="op">=</span>c,kernel<span class="op">=</span><span class="st">"linear"</span>)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    model <span class="op">=</span> model.fit(x_train,y_train)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>    yp_train<span class="op">=</span>model.predict(x_train)</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    yp_test<span class="op">=</span>model.predict(x_test)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(y_pred.shape)</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    test_results.append([c,accuracy_score(y_test, yp_test),recall_score(y_test, yp_test,average<span class="op">=</span><span class="va">None</span>)])</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    train_results.append([c,accuracy_score(y_train, yp_train),recall_score(y_train, yp_train,average<span class="op">=</span><span class="va">None</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(train_results)[:,<span class="dv">0</span>],np.array(train_results)[:,<span class="dv">1</span>],<span class="st">'-o'</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(test_results)[:,<span class="dv">0</span>],np.array(test_results)[:,<span class="dv">1</span>],<span class="st">'-o'</span>,c<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value of C in SVM"</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"ACCURACY: Training (blue) and Test (red)"</span>)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(train_results)[:,<span class="dv">0</span>],[y[<span class="dv">0</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(train_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(test_results)[:,<span class="dv">0</span>],[y[<span class="dv">0</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(test_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>,c<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value of C in SVM"</span>)</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"RECALL(Y=-1): Training (blue) and Test (red)"</span>)</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(train_results)[:,<span class="dv">0</span>],[y[<span class="dv">1</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(train_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(test_results)[:,<span class="dv">0</span>],[y[<span class="dv">1</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(test_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>,c<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value of C in SVM"</span>)</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"RECALL(Y=0): Training (blue) and Test (red)"</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(train_results)[:,<span class="dv">0</span>],[y[<span class="dv">2</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(train_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>plt.plot(np.array(test_results)[:,<span class="dv">0</span>],[y[<span class="dv">2</span>] <span class="cf">for</span> y <span class="kw">in</span> np.array(test_results)[:,<span class="dv">2</span>]],<span class="st">'-o'</span>,c<span class="op">=</span><span class="st">"red"</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Value of C in SVM"</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"RECALL(Y=1): Training (blue) and Test (red)"</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-18-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-18-output-3.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-18-output-4.png" class="img-fluid"></p>
</div>
</div>
<p>So based on the 4 graphs, I will choose C value from 0.35 to 0.5 as the best the model.</p>
</section>
<section id="optimal-model" class="level1">
<h1>07. Optimal Model</h1>
<p>I choose C = 0.8 for SVM model and let’s the model result.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#training the model with best Hyperparameter</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>clf <span class="op">=</span> SVC(C<span class="op">=</span><span class="fl">0.8</span>,kernel<span class="op">=</span><span class="st">"linear"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>clf.fit(x_train,y_train)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>yp_train <span class="op">=</span> clf.predict(x_train)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>yp_test <span class="op">=</span> clf.predict(x_test)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>con_mat_train <span class="op">=</span> confusion_matrix(y_train,yp_train,labels<span class="op">=</span>clf.classes_)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>con_mat_test <span class="op">=</span> confusion_matrix(y_test,yp_test,labels<span class="op">=</span>clf.classes_)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="co">#print the results and confusion matrix</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"------TRAINING------"</span>)</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>df_result1 <span class="op">=</span> classification_report(y_train,yp_train,output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>df_result1 <span class="op">=</span>pd.DataFrame(df_result1).T</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_result1)</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>con_mat_train,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                            display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>disp.plot()</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"confusion matrix for train data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>------TRAINING------
              precision    recall  f1-score   support
-1             0.996516  0.987910  0.992194   579.000
0              0.981667  0.998305  0.989916   590.000
1              0.996368  0.990373  0.993361   831.000
accuracy       0.992000  0.992000  0.992000     0.992
macro avg      0.991517  0.992196  0.991824  2000.000
weighted avg   0.992074  0.992000  0.992007  2000.000</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>Text(0.5, 1.0, 'confusion matrix for train data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-19-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"------TEST------"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df_result2 <span class="op">=</span> classification_report(y_test,yp_test,output_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>df_result2 <span class="op">=</span>pd.DataFrame(df_result2).T</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_result2)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>disp <span class="op">=</span> ConfusionMatrixDisplay(confusion_matrix<span class="op">=</span>con_mat_test,</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>                            display_labels<span class="op">=</span>clf.classes_)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>disp.plot()</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"confusion matrix for test data"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>------TEST------
              precision    recall  f1-score  support
-1             0.765306  0.630252  0.691244   119.00
0              0.677570  0.929487  0.783784   156.00
1              0.904255  0.755556  0.823245   225.00
accuracy       0.780000  0.780000  0.780000     0.78
macro avg      0.782377  0.771765  0.766091   500.00
weighted avg   0.800460  0.780000  0.779517   500.00</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>Text(0.5, 1.0, 'confusion matrix for test data')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="SVM_files/figure-html/cell-20-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>We can calculate the accuracy from confusion matrix of test data is <span class="math inline">\(\frac{75+145+170}{500} = 0.78\)</span>. Comparing to the old one which is 0.766, we improve the accuracy by around 0.2. Besides, recall and f1-score increased as well.</p>
</section>
<section id="conclusion" class="level1">
<h1>08. Conclusion</h1>
<p>From the last confusion matrix, we can see the true positive rate (recall) which represents the probability of predicting the tone is X (X can be one of “negative”,“positive”,“neural”) given the tone of input text is X. So, we can get 3 true positive rate for each tone and they are P(X=1|X=1) = <span class="math inline">\(0.756\)</span>, P(X=0|X=0) = <span class="math inline">\(0.929\)</span>, P(X=-1|X=-1) = <span class="math inline">\(0.63\)</span>. These numbers show that model will be more accurate in predicting the tone of neutral compared to the other two.</p>
<p>Also, the precision represents the quality of a positive prediction made by the model and we got 0.76 for “negative”, 0.677 for “neutral” and “0.904 for”positive”. So, prediction made by the model will have more correct labels in “positive”.</p>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<p>Code: https://github.com/anly501/anly-501-project-yanyanli0/tree/main/codes in 05-SVM file</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>