<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Clustering_files/libs/clipboard/clipboard.min.js"></script>
<script src="Clustering_files/libs/quarto-html/quarto.js"></script>
<script src="Clustering_files/libs/quarto-html/popper.min.js"></script>
<script src="Clustering_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Clustering_files/libs/quarto-html/anchor.min.js"></script>
<link href="Clustering_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Clustering_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Clustering_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Clustering_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Clustering_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-un-supervised-learning-clustering" id="toc-introduction-to-un-supervised-learning-clustering" class="nav-link active" data-scroll-target="#introduction-to-un-supervised-learning-clustering">Introduction to Un-supervised learning – Clustering</a>
  <ul class="collapse">
  <li><a href="#data-selection" id="toc-data-selection" class="nav-link" data-scroll-target="#data-selection">Data Selection</a></li>
  </ul></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data Preparation</a></li>
  <li><a href="#k-means-clustering" id="toc-k-means-clustering" class="nav-link" data-scroll-target="#k-means-clustering">K Means Clustering</a>
  <ul class="collapse">
  <li><a href="#optimal-k-means" id="toc-optimal-k-means" class="nav-link" data-scroll-target="#optimal-k-means">Optimal K means</a></li>
  </ul></li>
  <li><a href="#dbsan-clustering" id="toc-dbsan-clustering" class="nav-link" data-scroll-target="#dbsan-clustering">DBSAN Clustering</a>
  <ul class="collapse">
  <li><a href="#optimal-epsilon" id="toc-optimal-epsilon" class="nav-link" data-scroll-target="#optimal-epsilon">Optimal Epsilon</a></li>
  </ul></li>
  <li><a href="#agglomerative-clustering-hierarchical-clustering" id="toc-agglomerative-clustering-hierarchical-clustering" class="nav-link" data-scroll-target="#agglomerative-clustering-hierarchical-clustering">Agglomerative Clustering (Hierarchical clustering)</a>
  <ul class="collapse">
  <li><a href="#dendrogram" id="toc-dendrogram" class="nav-link" data-scroll-target="#dendrogram">Dendrogram</a></li>
  </ul></li>
  <li><a href="#result" id="toc-result" class="nav-link" data-scroll-target="#result">Result</a>
  <ul class="collapse">
  <li><a href="#agglomerative-clustering-in-2d" id="toc-agglomerative-clustering-in-2d" class="nav-link" data-scroll-target="#agglomerative-clustering-in-2d">Agglomerative Clustering in 2D</a></li>
  <li><a href="#dbscan-clustering-in-2d" id="toc-dbscan-clustering-in-2d" class="nav-link" data-scroll-target="#dbscan-clustering-in-2d">DBSCAN Clustering in 2D</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#reference" id="toc-reference" class="nav-link" data-scroll-target="#reference">Reference</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">



<div class="cell" data-execution_count="1">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans, AgglomerativeClustering, DBSCAN</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> cdist</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="introduction-to-un-supervised-learning-clustering" class="level1">
<h1>Introduction to Un-supervised learning – Clustering</h1>
<p>Unsupervised learning, also known as unsupervised machine learning, uses machine learning algorithms to analyze and cluster unlabeled datasets. These algorithms discover hidden patterns or data groupings without the need for human intervention(IBM). It is the good&nbsp;option for exploratory data analysis, cross-selling tactics, consumer segmentation, and picture identification because of its capacity to find similarities and differences in information.</p>
<p>In this section, we will focus on 3 different clustering methods to do the clustering analysis. The data set can be found on My Github called <a href="https://github.com/anly501/anly-501-project-yanyanli0/tree/main/data/01-modified-data">Drug_Consumption.csv</a> and can be download <a href="https://archive.ics.uci.edu/ml/datasets/Drug+consumption+%28quantified%29#">here</a>. The dataset has 1884 rows and 32 columns and each row represents the information about a participant. We will use the 6 columns (‘Age’,‘Gender’,‘Nscore’,‘Escore’,‘Cannabis’,‘Country’) and 1884 rows for the clustering analysis.</p>
<p><strong>Attribute Information</strong> <br> <strong>Age</strong> is age of a participant has one value from the list {‘55-64’, ‘18-24’, ‘45-54’, ‘25-34’, ‘65+’, ‘35-44’} <br> <strong>Gender</strong> is gender of participant: Female or Male <br> <strong>Country</strong> is country of current residence of participant has one value from the list {‘USA’, ‘Republic of Ireland’, ‘New Zealand’, ‘UK’, ‘Canada’, ‘Other’, ‘Australia’} <br> <strong>Nscore</strong> is NEO-FFI-R Neuroticism and is a numerical value. People who score high in neuroticism are very emotionally reactive. <br> <strong>Escore</strong> is NEO-FFI-R Extraversion and is a numerical value. Extraversion indicates how outgoing and social a person is. <br> <strong>Cannabis</strong> is class of cannabis consumption. It is output attribute with following distribution of classes. {‘CL0’, ‘CL1’, ‘CL2’, ‘CL3’, ‘CL4’, ‘CL5’, ‘CL6’} where <br> CL0 represents Never Used; <br> CL1 represents Used over a Decade Ago; <br> CL2 represents Used in Last Decade; <br> CL3 represents Used in Last Year; <br> CL4 represents Used in Last Month; <br> CL5 represents Used in Last Week; <br> CL6 represents Used in Last Day;</p>
<p>So, based on these select features, we will use all the columns except the ‘Cannabis’ to divide the data into different groups. Then compare the group labels we get from unsupervised machine learning with the ‘Cannabis’ group labels and check if the clustering predictions coincided with the ‘Cannabis’ group labels.</p>
<section id="data-selection" class="level2">
<h2 class="anchored" data-anchor-id="data-selection">Data Selection</h2>
<p>Choose the target columns which are ‘Age’, ‘Gender’, ‘Nscore’, ‘Escore’,‘Cannabis’,‘Country’</p>
<div class="cell" data-execution_count="2">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read the dataset</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>pd.read_csv(<span class="st">"Drug_Consumption.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="2">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>ID</th>
      <th>Age</th>
      <th>Gender</th>
      <th>Education</th>
      <th>Country</th>
      <th>Ethnicity</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Oscore</th>
      <th>AScore</th>
      <th>...</th>
      <th>Ecstasy</th>
      <th>Heroin</th>
      <th>Ketamine</th>
      <th>Legalh</th>
      <th>LSD</th>
      <th>Meth</th>
      <th>Mushrooms</th>
      <th>Nicotine</th>
      <th>Semer</th>
      <th>VSA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
      <td>25-34</td>
      <td>M</td>
      <td>Doctorate degree</td>
      <td>UK</td>
      <td>White</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>1.43533</td>
      <td>0.76096</td>
      <td>...</td>
      <td>CL4</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL4</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>35-44</td>
      <td>M</td>
      <td>Professional certificate/ diploma</td>
      <td>UK</td>
      <td>White</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>-0.84732</td>
      <td>-1.62090</td>
      <td>...</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL1</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
      <td>18-24</td>
      <td>F</td>
      <td>Masters degree</td>
      <td>UK</td>
      <td>White</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>-0.01928</td>
      <td>0.59042</td>
      <td>...</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>35-44</td>
      <td>F</td>
      <td>Doctorate degree</td>
      <td>UK</td>
      <td>White</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>-0.45174</td>
      <td>-0.30172</td>
      <td>...</td>
      <td>CL1</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL1</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>6</td>
      <td>65+</td>
      <td>F</td>
      <td>Left school at 18 years</td>
      <td>Canada</td>
      <td>White</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>-1.55521</td>
      <td>2.03972</td>
      <td>...</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL6</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1879</th>
      <td>1884</td>
      <td>18-24</td>
      <td>F</td>
      <td>Some college or university, no certificate or ...</td>
      <td>USA</td>
      <td>White</td>
      <td>-1.19430</td>
      <td>1.74091</td>
      <td>1.88511</td>
      <td>0.76096</td>
      <td>...</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL5</td>
    </tr>
    <tr>
      <th>1880</th>
      <td>1885</td>
      <td>18-24</td>
      <td>M</td>
      <td>Some college or university, no certificate or ...</td>
      <td>USA</td>
      <td>White</td>
      <td>-0.24649</td>
      <td>1.74091</td>
      <td>0.58331</td>
      <td>0.76096</td>
      <td>...</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL5</td>
      <td>CL4</td>
      <td>CL4</td>
      <td>CL5</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>1881</th>
      <td>1886</td>
      <td>25-34</td>
      <td>F</td>
      <td>University degree</td>
      <td>USA</td>
      <td>White</td>
      <td>1.13281</td>
      <td>-1.37639</td>
      <td>-1.27553</td>
      <td>-1.77200</td>
      <td>...</td>
      <td>CL4</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL0</td>
      <td>CL2</td>
      <td>CL6</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>1882</th>
      <td>1887</td>
      <td>18-24</td>
      <td>F</td>
      <td>Some college or university, no certificate or ...</td>
      <td>USA</td>
      <td>White</td>
      <td>0.91093</td>
      <td>-1.92173</td>
      <td>0.29338</td>
      <td>-1.62090</td>
      <td>...</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL4</td>
      <td>CL0</td>
      <td>CL0</td>
    </tr>
    <tr>
      <th>1883</th>
      <td>1888</td>
      <td>18-24</td>
      <td>M</td>
      <td>Some college or university, no certificate or ...</td>
      <td>Republic of Ireland</td>
      <td>White</td>
      <td>-0.46725</td>
      <td>2.12700</td>
      <td>1.65653</td>
      <td>1.11406</td>
      <td>...</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL3</td>
      <td>CL0</td>
      <td>CL3</td>
      <td>CL6</td>
      <td>CL0</td>
      <td>CL2</td>
    </tr>
  </tbody>
</table>
<p>1884 rows × 32 columns</p>
</div>
</div>
</div>
<p>Entire dataset (1884 rows × 32 columns)</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose columns</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df[[<span class="st">'Age'</span>, <span class="st">'Gender'</span>, <span class="st">'Nscore'</span>, <span class="st">'Escore'</span>,<span class="st">'Cannabis'</span>,<span class="st">'Country'</span>]]</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Cannabis</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25-34</td>
      <td>M</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>CL4</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>35-44</td>
      <td>M</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>CL3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>18-24</td>
      <td>F</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>CL2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>35-44</td>
      <td>F</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>CL3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65+</td>
      <td>F</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>CL0</td>
      <td>Canada</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1879</th>
      <td>18-24</td>
      <td>F</td>
      <td>-1.19430</td>
      <td>1.74091</td>
      <td>CL5</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1880</th>
      <td>18-24</td>
      <td>M</td>
      <td>-0.24649</td>
      <td>1.74091</td>
      <td>CL3</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1881</th>
      <td>25-34</td>
      <td>F</td>
      <td>1.13281</td>
      <td>-1.37639</td>
      <td>CL6</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1882</th>
      <td>18-24</td>
      <td>F</td>
      <td>0.91093</td>
      <td>-1.92173</td>
      <td>CL6</td>
      <td>USA</td>
    </tr>
    <tr>
      <th>1883</th>
      <td>18-24</td>
      <td>M</td>
      <td>-0.46725</td>
      <td>2.12700</td>
      <td>CL3</td>
      <td>Republic of Ireland</td>
    </tr>
  </tbody>
</table>
<p>1884 rows × 6 columns</p>
</div>
</div>
</div>
<p>Selected dataset (1884 rows × 6 columns)</p>
</section>
</section>
<section id="data-preparation" class="level1">
<h1>Data Preparation</h1>
<li>
Replace the values in Column ‘Age’ with it median
</li>
<p><br> For example, the first row has ‘25-34’ in Age column and it will be replaced with 29.5</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#replace the age with their median</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'18-24'</span>, <span class="dv">21</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'25-34'</span>, <span class="fl">29.5</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'55-64'</span>, <span class="fl">59.5</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'45-54'</span>, <span class="fl">49.5</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'35-44'</span>, <span class="fl">39.5</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">'65+'</span>, <span class="dv">65</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#show first rows</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Cannabis</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.5</td>
      <td>M</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>CL4</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>M</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>CL3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.0</td>
      <td>F</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>CL2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39.5</td>
      <td>F</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>CL3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65.0</td>
      <td>F</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>CL0</td>
      <td>Canada</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<li>
Replace the categorical values in Cannabis with category codes
</li>
<div class="cell" data-execution_count="6">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">dict</span>(<span class="bu">enumerate</span>(df[<span class="st">'Cannabis'</span>].astype(<span class="st">'category'</span>).cat.categories)))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Cannabis'</span>]<span class="op">=</span>df[<span class="st">'Cannabis'</span>].astype(<span class="st">'category'</span>).cat.codes</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{0: 'CL0', 1: 'CL1', 2: 'CL2', 3: 'CL3', 4: 'CL4', 5: 'CL5', 6: 'CL6'}</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Cannabis</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.5</td>
      <td>M</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>4</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>M</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.0</td>
      <td>F</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39.5</td>
      <td>F</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65.0</td>
      <td>F</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>0</td>
      <td>Canada</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<li>
Replace the categorical values in Gender with 1 indicating male and 0 indicating female
</li>
<div class="cell" data-execution_count="7">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">dict</span>(<span class="bu">enumerate</span>(df[<span class="st">'Gender'</span>].astype(<span class="st">'category'</span>).cat.categories)))</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Gender'</span>]<span class="op">=</span>df[<span class="st">'Gender'</span>].astype(<span class="st">'category'</span>).cat.codes</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{0: 'F', 1: 'M'}</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Cannabis</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.5</td>
      <td>1</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>4</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>1</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.0</td>
      <td>0</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>2</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39.5</td>
      <td>0</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>3</td>
      <td>UK</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65.0</td>
      <td>0</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>0</td>
      <td>Canada</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<li>
Replace the categorical values in Country
</li>
<div class="cell" data-execution_count="8">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">dict</span>(<span class="bu">enumerate</span>(df[<span class="st">'Country'</span>].astype(<span class="st">'category'</span>).cat.categories)))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Country'</span>]<span class="op">=</span>df[<span class="st">'Country'</span>].astype(<span class="st">'category'</span>).cat.codes</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>{0: 'Australia', 1: 'Canada', 2: 'New Zealand', 3: 'Other', 4: 'Republic of Ireland', 5: 'UK', 6: 'USA'}</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Cannabis</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>29.5</td>
      <td>1</td>
      <td>-0.67825</td>
      <td>1.93886</td>
      <td>4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>39.5</td>
      <td>1</td>
      <td>-0.46725</td>
      <td>0.80523</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.0</td>
      <td>0</td>
      <td>-0.14882</td>
      <td>-0.80615</td>
      <td>2</td>
      <td>5</td>
    </tr>
    <tr>
      <th>3</th>
      <td>39.5</td>
      <td>0</td>
      <td>0.73545</td>
      <td>-1.63340</td>
      <td>3</td>
      <td>5</td>
    </tr>
    <tr>
      <th>4</th>
      <td>65.0</td>
      <td>0</td>
      <td>-0.67825</td>
      <td>-0.30033</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<li>
Normalize the numerical data
</li>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>X<span class="op">=</span>df.drop([<span class="st">'Cannabis'</span>],axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>y<span class="op">=</span>df[<span class="st">'Cannabis'</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>scalar <span class="op">=</span> StandardScaler()</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>scalar.fit(X)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scalar.transform(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="10">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(X,columns<span class="op">=</span>[<span class="st">'Age'</span>,<span class="st">'Gender'</span>,<span class="st">'Nscore'</span>,<span class="st">'Escore'</span>,<span class="st">'Country'</span>]).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Age</th>
      <th>Gender</th>
      <th>Nscore</th>
      <th>Escore</th>
      <th>Country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.323689</td>
      <td>0.998939</td>
      <td>-0.679435</td>
      <td>1.943848</td>
      <td>0.12445</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.501130</td>
      <td>0.998939</td>
      <td>-0.468029</td>
      <td>0.807218</td>
      <td>0.12445</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.024784</td>
      <td>-1.001062</td>
      <td>-0.148987</td>
      <td>-0.808426</td>
      <td>0.12445</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.501130</td>
      <td>-1.001062</td>
      <td>0.736985</td>
      <td>-1.637866</td>
      <td>0.12445</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2.604416</td>
      <td>-1.001062</td>
      <td>-0.679435</td>
      <td>-0.301268</td>
      <td>-2.70042</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
</section>
<section id="k-means-clustering" class="level1">
<h1>K Means Clustering</h1>
<p>K-means is a centroid-based clustering technique where each data point is assigned to a cluster based on the distance between it and a centroid. Finding the K number of groups in the dataset is the objective.</p>
<p>Now, we are going to use two methods called Elbow method and Silhouette method to find the ideal number of K.</p>
<p>Elbow method contains two measurement one is distortions and another one is inertias. Both of them measure how far the data point is from the centroid of assigned the cluster. We are going to plot distortions/inertias vs Number of Clustering, and our goal is to pick the elbow of the curve as the number of clusters to use.</p>
<p>Silhouette method is to calculate the Silhouette score with different number of cluster. Since, Silhouette score is used to evaluate the quality of clusters created. So, our goal for this method is to find the Number of clusters with highest Silhouette score.</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.cluster</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> maximize_silhouette(X,algo<span class="op">=</span><span class="st">"birch"</span>,nmax<span class="op">=</span><span class="dv">20</span>,i_plot<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PARAM</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    i_print<span class="op">=</span><span class="va">False</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#FORCE CONTIGUOUS</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    X<span class="op">=</span>np.ascontiguousarray(X) </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># LOOP OVER HYPER-PARAM</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    params<span class="op">=</span>[]<span class="op">;</span> sil_scores<span class="op">=</span>[]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    sil_max<span class="op">=-</span><span class="dv">10</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> param <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>,nmax<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(algo<span class="op">==</span><span class="st">"ag"</span>):</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> sklearn.cluster.AgglomerativeClustering(n_clusters<span class="op">=</span>param).fit(X)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>            labels<span class="op">=</span>model.labels_</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(algo<span class="op">==</span><span class="st">"dbscan"</span>):</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>            param<span class="op">=</span><span class="fl">0.5</span><span class="op">*</span>(param<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> sklearn.cluster.DBSCAN(eps<span class="op">=</span>param).fit(X)</span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>            labels<span class="op">=</span>model.labels_</span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(algo<span class="op">==</span><span class="st">"kmeans"</span>):</span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>            model <span class="op">=</span> sklearn.cluster.KMeans(n_clusters<span class="op">=</span>param).fit(X)</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>            labels<span class="op">=</span>model.predict(X)</span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>            sil_scores.append(sklearn.metrics.silhouette_score(X,labels))</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>            params.append(param)</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span>:</span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span> </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(i_print): <span class="bu">print</span>(param,sil_scores[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span>(sil_scores[<span class="op">-</span><span class="dv">1</span>]<span class="op">&gt;</span>sil_max):</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>             opt_param<span class="op">=</span>param</span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>             sil_max<span class="op">=</span>sil_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>             opt_labels<span class="op">=</span>labels</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"OPTIMAL PARAMETER ="</span>,opt_param)</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(i_plot):</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>        ax.plot(params, sil_scores, <span class="st">"-o"</span>)  </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>        ax.<span class="bu">set</span>(xlabel<span class="op">=</span><span class="st">'Hyper-parameter'</span>, ylabel<span class="op">=</span><span class="st">'Silhouette'</span>)</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>        plt.show()</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> opt_labels</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="12">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>NDIM <span class="op">=</span><span class="dv">5</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot(title<span class="op">=</span><span class="st">''</span>):</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(NDIM<span class="op">==</span><span class="dv">2</span>):</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>        fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>        sp<span class="op">=</span>ax.scatter(X[:,<span class="dv">0</span>], X[:,<span class="dv">1</span>],c<span class="op">=</span>labels,marker<span class="op">=</span><span class="st">"."</span>, cmap<span class="op">=</span><span class="st">"viridis"</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>        plt.colorbar(sp)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(NDIM<span class="op">==</span><span class="dv">3</span>):</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> plt.figure()</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        sp<span class="op">=</span>ax.scatter(X[:,<span class="dv">0</span>],X[:,<span class="dv">1</span>],X[:,<span class="dv">2</span>],c<span class="op">=</span>labels,marker<span class="op">=</span><span class="st">"."</span>, cmap<span class="op">=</span><span class="st">"viridis"</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>        plt.colorbar(sp)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#DO PCA TO VISUALIZE</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(NDIM<span class="op">&gt;</span><span class="dv">3</span>):</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="im">from</span> sklearn.decomposition <span class="im">import</span> PCA</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        pca <span class="op">=</span> PCA(n_components<span class="op">=</span><span class="dv">3</span>)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>        pca.fit(X)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>        Y<span class="op">=</span>pca.fit_transform(X)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>        fig <span class="op">=</span> plt.figure()</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>        ax <span class="op">=</span> fig.add_subplot(projection<span class="op">=</span><span class="st">'3d'</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>        sp<span class="op">=</span>ax.scatter(Y[:,<span class="dv">0</span>],Y[:,<span class="dv">1</span>],Y[:,<span class="dv">2</span>],c<span class="op">=</span>labels,marker<span class="op">=</span><span class="st">"."</span>, cmap<span class="op">=</span><span class="st">"viridis"</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>        plt.colorbar(sp)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    plt.title(title)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>distortions <span class="op">=</span> []</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>inertias <span class="op">=</span> []</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> K:</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Building and fitting the model</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    kmeanModel <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k).fit(X)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    kmeanModel.fit(X)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    distortions.append(<span class="bu">sum</span>(np.<span class="bu">min</span>(cdist(X, kmeanModel.cluster_centers_,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="st">'euclidean'</span>), axis<span class="op">=</span><span class="dv">1</span>)) <span class="op">/</span> X.shape[<span class="dv">0</span>])</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    inertias.append(kmeanModel.inertia_)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>elbow<span class="op">=</span>pd.DataFrame({<span class="st">'Cluster'</span>:K,<span class="st">'Distortion'</span>:distortions,<span class="st">'Inertia'</span>:inertias})   </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>elbow[<span class="st">'Cluster'</span>],y<span class="op">=</span>elbow[<span class="st">'Distortion'</span>],ax<span class="op">=</span>ax[<span class="dv">0</span>],palette <span class="op">=</span> <span class="st">'green'</span>, label<span class="op">=</span><span class="st">"Distortion"</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>sns.lineplot(x<span class="op">=</span>elbow[<span class="st">'Cluster'</span>],y<span class="op">=</span>elbow[<span class="st">'Inertia'</span>],ax<span class="op">=</span>ax[<span class="dv">1</span>],color<span class="op">=</span><span class="st">'orange'</span>, label<span class="op">=</span><span class="st">"Inertia"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Number of K"</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>opt_labels<span class="op">=</span>maximize_silhouette(X,algo<span class="op">=</span><span class="st">"kmeans"</span>,nmax<span class="op">=</span><span class="dv">15</span>, i_plot<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OPTIMAL PARAMETER = 8</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-15-output-2.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-15-output-3.png" class="img-fluid"></p>
</div>
</div>
<p>From the two graphs above, we can see the highest Silhouette score is around 0.257 when the cluster size is 8.</p>
<section id="optimal-k-means" class="level2">
<h2 class="anchored" data-anchor-id="optimal-k-means">Optimal K means</h2>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Kmean <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">8</span>).fit(X)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'label_kmean'</span>]<span class="op">=</span>Kmean.fit_predict(X)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>df[<span class="st">'label_kmean'</span>]</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>plot(title<span class="op">=</span><span class="st">'Kmeans labels with number of cluster ='</span><span class="op">+</span><span class="bu">str</span>(<span class="dv">8</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-16-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="dbsan-clustering" class="level1">
<h1>DBSAN Clustering</h1>
<p>It creates a cluster from “densely organized” data points. By examining the local density of the data points, it may locate clusters in big geographical datasets. The sensitivity to outliers of DBSCAN clustering is its most exciting characteristic. Additionally, unlike K-Means, which requires us to specify the number of centroids, it does not require us to know in advance how many clusters will be present (Sharma). Besides, the DBSAN Clustering only have two parameters epsilon and mini sample size. The epsilon represents the radius of the circle centered at the each data point and mini sample size represents the minimum number of data points required in the circle.</p>
<p>So, in this section, we will find the best optimal epsilon and mini sample size then apply DBSCAN clustering on the dataset and visualize the result.</p>
<section id="optimal-epsilon" class="level2">
<h2 class="anchored" data-anchor-id="optimal-epsilon">Optimal Epsilon</h2>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>opt_labels<span class="op">=</span>maximize_silhouette(X,algo<span class="op">=</span><span class="st">"dbscan"</span>,nmax<span class="op">=</span><span class="dv">15</span>, i_plot<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OPTIMAL PARAMETER = 2.0</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-17-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(<span class="dv">14</span>,<span class="dv">8</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="dv">2</span>,min_samples<span class="op">=</span><span class="dv">20</span>).fit(X)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'label_db'</span>]<span class="op">=</span>db.fit_predict(X)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>df[<span class="st">'label_db'</span>]</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>plot(title<span class="op">=</span><span class="st">'DBSCAN labels with number of cluster =='</span><span class="op">+</span><span class="bu">str</span>(<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-18-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="agglomerative-clustering-hierarchical-clustering" class="level1">
<h1>Agglomerative Clustering (Hierarchical clustering)</h1>
<p>Agglomerative Clustering is also called Hierarchical clustering. It is one of the unsupervised machine learning methods that can divide the data into different groups based on the similarity of each data. So, the data in the same cluster have similar feature and data in different cluster are less similar.</p>
<p>The Agglomerative Clustering method only require one parameter which is number of cluster. We will find the optimal cluster size dendrogram method and visualize the optimal result</p>
<section id="dendrogram" class="level2">
<h2 class="anchored" data-anchor-id="dendrogram">Dendrogram</h2>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> dendrogram</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Agg<span class="op">=</span> AgglomerativeClustering(distance_threshold<span class="op">=</span><span class="dv">0</span>, n_clusters<span class="op">=</span><span class="va">None</span>).fit(X)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_dendrogram(model, <span class="op">**</span>kwargs):</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create linkage matrix and then plot the dendrogram</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># create the counts of samples under each node</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    counts <span class="op">=</span> np.zeros(model.children_.shape[<span class="dv">0</span>])</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    n_samples <span class="op">=</span> <span class="bu">len</span>(model.labels_)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, merge <span class="kw">in</span> <span class="bu">enumerate</span>(model.children_):</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>        current_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child_idx <span class="kw">in</span> merge:</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> child_idx <span class="op">&lt;</span> n_samples:</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>                current_count <span class="op">+=</span> <span class="dv">1</span>  <span class="co"># leaf node</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>                current_count <span class="op">+=</span> counts[child_idx <span class="op">-</span> n_samples]</span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>        counts[i] <span class="op">=</span> current_count</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>    linkage_matrix <span class="op">=</span> np.column_stack(</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        [model.children_, model.distances_, counts]</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    ).astype(<span class="bu">float</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Plot the corresponding dendrogram</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>    dendrogram(linkage_matrix, <span class="op">**</span>kwargs)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>plot_dendrogram(Agg, truncate_mode<span class="op">=</span><span class="st">"level"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>opt_labels<span class="op">=</span>maximize_silhouette(X,algo<span class="op">=</span><span class="st">"ag"</span>,nmax<span class="op">=</span><span class="dv">15</span>, i_plot<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>OPTIMAL PARAMETER = 3</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches(<span class="dv">14</span>,<span class="dv">8</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>Agg <span class="op">=</span> AgglomerativeClustering(n_clusters<span class="op">=</span><span class="dv">3</span>).fit(X)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'label_agg'</span>]<span class="op">=</span>Agg.fit_predict(X)</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>labels<span class="op">=</span>df[<span class="st">'label_agg'</span>]</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>plot(title<span class="op">=</span><span class="st">'Agglomerative labels with number of cluster ='</span><span class="op">+</span><span class="bu">str</span>(<span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-21-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
</section>
<section id="result" class="level1">
<h1>Result</h1>
<p>Let’s plot the data based on the and put all four graphs together and compare them with the data labeled by ‘Cannabis’</p>
<p><img src="kmeans.png" alt="drawing" width="340"></p>
<p><img src="DBSCAN.png" alt="drawing" width="350"></p>
<p><img src="Agg.png" alt="drawing" width="355"></p>
<p><img src="normal.png" alt="drawing" width="340"></p>
<p>From the four graphs above, we can clearly see that different methods divide the data into different size of clusters. K means has 8 clusters, dbscan only have 2 clusters and the agglomerative has 3 clusters.</p>
<p>All of the results don’t match the Cannabis labels in the dataset. The K means cluster has the most different cluster sizes.</p>
<p>Let’s visualize the data points into 2D and see what we can discover</p>
<div class="cell" data-execution_count="47">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>Index(['Age', 'Gender', 'Nscore', 'Escore', 'Cannabis', 'Country',
       'label_kmean', 'label_db', 'label_agg'],
      dtype='object')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="53">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,sharex<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Score vs Country'</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Age'</span>,y<span class="op">=</span><span class="st">'Nscore'</span>,hue<span class="op">=</span><span class="st">'label_kmean'</span>,ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Age'</span>,y<span class="op">=</span><span class="st">'Escore'</span>,hue<span class="op">=</span><span class="st">'label_kmean'</span>,ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Nscore vs Country'</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Escore vs Country'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>Text(0.5, 1.0, 'Escore vs Country')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-23-output-2.png" class="img-fluid"></p>
</div>
</div>
<section id="agglomerative-clustering-in-2d" class="level2">
<h2 class="anchored" data-anchor-id="agglomerative-clustering-in-2d">Agglomerative Clustering in 2D</h2>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,sharex<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Score vs Country'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Country'</span>,y<span class="op">=</span><span class="st">'Nscore'</span>,hue<span class="op">=</span><span class="st">'label_agg'</span>,ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Country'</span>,y<span class="op">=</span><span class="st">'Escore'</span>,hue<span class="op">=</span><span class="st">'label_agg'</span>,ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Nscore vs Country'</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Escore vs Country'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>Text(0.5, 1.0, 'Escore vs Country')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-24-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>From the graph, we can tell that the almost all the black points are located on Country 0 to 3 and rest the points are coming from Country 3 to 6. And the range of Nscore of black points is around -2.5 to 2 and same for the Escore.</p>
</section>
<section id="dbscan-clustering-in-2d" class="level2">
<h2 class="anchored" data-anchor-id="dbscan-clustering-in-2d">DBSCAN Clustering in 2D</h2>
<div class="cell" data-execution_count="23">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>fig,ax<span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>,sharex<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>fig.suptitle(<span class="st">'Score vs Gender'</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Gender'</span>,y<span class="op">=</span><span class="st">'Nscore'</span>,hue<span class="op">=</span><span class="st">'label_db'</span>,ax<span class="op">=</span>ax[<span class="dv">0</span>])</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data<span class="op">=</span>df,x<span class="op">=</span><span class="st">'Gender'</span>,y<span class="op">=</span><span class="st">'Escore'</span>,hue<span class="op">=</span><span class="st">'label_db'</span>,ax<span class="op">=</span>ax[<span class="dv">1</span>])</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Nscore vs Gender'</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Escore vs Gender'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>Text(0.5, 1.0, 'Escore vs Gender')</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Clustering_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>From above graphs, we can see the DBSCAN method divide all the data points into two groups based on their gender– Female(0) and Male(1). From the left hand side graph, we can see the more orange group sightly higher than the blue points group. Since the organ group is Gender 0 which represents female, we can tell the average Nscore of female is higher than male’s. Similarly, for the right hand side graph, we can see more orange points are concentrated on -3 to 3 and blue points are concentrated on -3 to 2.5. So, the average female Escore are higher than male’s as well.</p>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Overall, different clustering methods will divide the dataset into different group based on different standard or data similarity. For example, we can clearly see the DBSCAN clustering has perfect two gender clusters and other method dont have more than two groups. So, I think it is useful to apply multiple clustering on the same dataset to find their features in different ways.</p>
<p>What I found in DBSCAN clustering is the average Nscore/Escore of female is higher than male’s, which shows that female are more emotionally reactive than male. From the Wikipedia, research has suggested that women express emotions more frequently than men on average. Multiple researchers have found that women cry more frequently, and for longer durations than men at similar ages. This view is completely consistent with our results .</p>
<p>In the end, since these three methods didnt predicts the same labels as Cannabis, I think there are might be other key features that need to be consider.</p>
</section>
<section id="reference" class="level1">
<h1>Reference</h1>
<p>IBM Cloud Education. (n.d.). What is unsupervised learning? IBM. Retrieved November 6, 2022, from https://www.ibm.com/cloud/learn/unsupervised-learning#:~:text=Unsupervised%20learning%2C%20also%20known%20as,the%20need%20for%20human%20intervention.</p>
<p>Sharma, A. (2022, June 20). How does DBSCAN clustering work?: DBSCAN clustering for ML. Analytics Vidhya. Retrieved November 10, 2022, from https://www.analyticsvidhya.com/blog/2020/09/how-dbscan-clustering-works/</p>
<p>Wikimedia Foundation. (2022, August 20). Gender and emotional expression. Wikipedia. Retrieved November 11, 2022, from https://en.wikipedia.org/wiki/Gender_and_emotional_expression</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>