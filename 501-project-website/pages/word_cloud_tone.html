<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.242">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<link rel="stylesheet" href="styles.css" type="text/css">

<title>word_cloud_tone</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<script src="nav.js"></script>

<script src="word_cloud_tone_files/libs/clipboard/clipboard.min.js"></script>
<script src="word_cloud_tone_files/libs/quarto-html/quarto.js"></script>
<script src="word_cloud_tone_files/libs/quarto-html/popper.min.js"></script>
<script src="word_cloud_tone_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="word_cloud_tone_files/libs/quarto-html/anchor.min.js"></script>
<link href="word_cloud_tone_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="word_cloud_tone_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="word_cloud_tone_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="word_cloud_tone_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="word_cloud_tone_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#introduction-to-data-exploring" id="toc-introduction-to-data-exploring" class="nav-link active" data-scroll-target="#introduction-to-data-exploring">Introduction to Data Exploring</a></li>
  <li><a href="#tweets-dataset" id="toc-tweets-dataset" class="nav-link" data-scroll-target="#tweets-dataset">Tweets Dataset</a>
  <ul class="collapse">
  <li><a href="#world-cloud" id="toc-world-cloud" class="nav-link" data-scroll-target="#world-cloud">World Cloud</a></li>
  <li><a href="#explore-the-sentiment-of-each-tweet" id="toc-explore-the-sentiment-of-each-tweet" class="nav-link" data-scroll-target="#explore-the-sentiment-of-each-tweet">Explore the sentiment of each tweet</a>
  <ul class="collapse">
  <li><a href="#text-vectorization" id="toc-text-vectorization" class="nav-link" data-scroll-target="#text-vectorization">Text Vectorization</a></li>
  <li><a href="#remove-stop-words-and-word-stemminglemmatization" id="toc-remove-stop-words-and-word-stemminglemmatization" class="nav-link" data-scroll-target="#remove-stop-words-and-word-stemminglemmatization">Remove Stop words and Word Stemming/Lemmatization</a></li>
  </ul></li>
  <li><a href="#count-vectorizer" id="toc-count-vectorizer" class="nav-link" data-scroll-target="#count-vectorizer">Count Vectorizer</a></li>
  <li><a href="#sentiment-score" id="toc-sentiment-score" class="nav-link" data-scroll-target="#sentiment-score">Sentiment Score</a></li>
  </ul></li>
  <li><a href="#open-fda-criminal-rate-data" id="toc-open-fda-criminal-rate-data" class="nav-link" data-scroll-target="#open-fda-criminal-rate-data">Open FDA Criminal Rate Data</a>
  <ul class="collapse">
  <li><a href="#statics-values-of-dataset" id="toc-statics-values-of-dataset" class="nav-link" data-scroll-target="#statics-values-of-dataset">Statics values of Dataset</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">



<section id="introduction-to-data-exploring" class="level1">
<h1>Introduction to Data Exploring</h1>
<p>Data exploration is the initial step in data analysis, where users explore a large data set in an unstructured way to uncover initial patterns, characteristics, and points of interest. Data exploration is a crucial part of data science, and it’s important to approach it with curiosity and an open mind. This process isn’t meant to reveal every bit of information a dataset holds, but rather to help create a broad picture of important trends and major points to study in greater detail. Data exploration can be done manually, through visual inspection of data, or by using automated methods such as data mining. Whichever approach you take, the goal is the same: to get a better understanding of your data so that you can make more informed decisions about how to analyze it.</p>
<div class="cell" data-execution_count="13">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import packages</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> wordcloud <span class="im">import</span> WordCloud</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> integrate</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.feature_extraction.text <span class="im">import</span> CountVectorizer</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> nltk</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> string</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> nltk.sentiment.vader <span class="im">import</span> SentimentIntensityAnalyzer</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="tweets-dataset" class="level1">
<h1>Tweets Dataset</h1>
<p>Go to the Data Gathering tab for more details on how the data being collected.</p>
<div class="cell" data-execution_count="14">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read file</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>tweet<span class="op">=</span>pd.read_csv(<span class="st">"cleaned_tweet_df.csv"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>content<span class="op">=</span>tweet[<span class="st">'clean_text'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="15">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join all tweet into a big chunk of string</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>s<span class="op">=</span><span class="st">''</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> content:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    s<span class="op">+=</span>i</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="world-cloud" class="level2">
<h2 class="anchored" data-anchor-id="world-cloud">World Cloud</h2>
<div class="cell" data-execution_count="16">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the wordcloud</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>wordcloud <span class="op">=</span> WordCloud(width <span class="op">=</span> <span class="dv">800</span>, height <span class="op">=</span> <span class="dv">800</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                background_color <span class="op">=</span><span class="st">'white'</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>                min_font_size <span class="op">=</span> <span class="dv">5</span>).generate(s)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">8</span>, <span class="dv">8</span>), facecolor <span class="op">=</span> <span class="va">None</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>plt.imshow(wordcloud)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">"off"</span>)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>plt.tight_layout(pad <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="word_cloud_tone_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>So from the wold Cloud we can clearly see the most outstanding words are “Weed”,“Marijuana”, and “Cannabis” etc. They are our target words. <br> Also, we can see some words like “Good”, “Bad”, “don’t” etc. to represent people’s views or emotions on Marijuana. So let’s analysis the tone or mood of each tweets.</p>
</section>
<section id="explore-the-sentiment-of-each-tweet" class="level2">
<h2 class="anchored" data-anchor-id="explore-the-sentiment-of-each-tweet">Explore the sentiment of each tweet</h2>
<section id="text-vectorization" class="level3">
<h3 class="anchored" data-anchor-id="text-vectorization">Text Vectorization</h3>
<p>Text Vectorization is the process of converting text into numerical representation. Here, we used a tool called CountVectorizer from Python Sklearns library. It can count the frequency of each word and use the frequency as the features.</p>
</section>
<section id="remove-stop-words-and-word-stemminglemmatization" class="level3">
<h3 class="anchored" data-anchor-id="remove-stop-words-and-word-stemminglemmatization">Remove Stop words and Word Stemming/Lemmatization</h3>
<p>Stopwords are the most common words of a language like ‘I’, ‘this’, ‘is’, ‘in’ which do not add much value to the meaning of a document. These values are removed to decrease the dataset size and increase focus on meaningful words.</p>
<p>Stemming is a process that stems or removes last few characters from a word, often leading to incorrect meanings and spelling. Lemmatization considers the context and converts the word to its meaningful base form</p>
<div class="cell" data-execution_count="17">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importing spacy</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading model</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">'en_core_web_sm'</span>,disable<span class="op">=</span>[<span class="st">'parser'</span>, <span class="st">'ner'</span>])</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Lemmatization with stopwords removal</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>tweet[<span class="st">'lemmatized'</span>]<span class="op">=</span>tweet[<span class="st">'clean_text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="st">' '</span>.join([token.lemma_ <span class="cf">for</span> token <span class="kw">in</span> <span class="bu">list</span>(nlp(x)) <span class="cf">if</span> (token.is_stop<span class="op">==</span><span class="va">False</span>)]))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>d:\python\envs\ANLY580\lib\site-packages\tqdm\auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>tweet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Unnamed: 0</th>
      <th>Date</th>
      <th>Language</th>
      <th>Text</th>
      <th>clean_text</th>
      <th>lemmatized</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>2022-09-11 22:22:28+00:00</td>
      <td>en</td>
      <td>All the medical pain and all the taxes spent p...</td>
      <td>medical pain taxes spent putting people jail s...</td>
      <td>medical pain taxis spend put people jail sin b...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>2022-09-11 22:21:26+00:00</td>
      <td>en</td>
      <td>A good way to clean up your follower list is t...</td>
      <td>good way clean follower list app called see fo...</td>
      <td>good way clean follower list app call follow l...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>2022-09-11 22:12:16+00:00</td>
      <td>en</td>
      <td>@1zzyzyx1 @MeidasTouch @CharlieCrist legalize ...</td>
      <td>legalize marijuana remove barriers desantis p...</td>
      <td>legalize marijuana remove barrier desantis p...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>2022-09-11 22:11:15+00:00</td>
      <td>en</td>
      <td>RT @snoopdoggslungz: 📸 Chem D\n🌱(ig) https://t...</td>
      <td>rt chem d ig</td>
      <td>rt chem d ig</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>2022-09-11 22:06:53+00:00</td>
      <td>en</td>
      <td>@BabzOnTheMic Off the weed bro. That’s 4 strai...</td>
      <td>weed bro thats straight losses miami pats lon...</td>
      <td>weed bro s straight loss miami pat long thre...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>2495</td>
      <td>2022-09-07 21:20:14+00:00</td>
      <td>en</td>
      <td>I just caught someone smoking their weed pen i...</td>
      <td>caught someone smoking weed pen class hahahaha...</td>
      <td>catch smoking weed pen class hahahahahahahaha ...</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>2496</td>
      <td>2022-09-07 21:17:48+00:00</td>
      <td>en</td>
      <td>@AesPolitics And research shows black and brow...</td>
      <td>research shows black brown people disproporti...</td>
      <td>research show black brown people disproporti...</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>2497</td>
      <td>2022-09-07 21:17:39+00:00</td>
      <td>en</td>
      <td>Smoke weed “ your not responsible and mentally...</td>
      <td>smoke weed responsible mentally sick sober ser...</td>
      <td>smoke weed responsible mentally sick sober bou...</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>2498</td>
      <td>2022-09-07 21:09:58+00:00</td>
      <td>en</td>
      <td>People who call weed, cannabis. https://t.co/m...</td>
      <td>people call weed cannabis</td>
      <td>people weed cannabis</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>2499</td>
      <td>2022-09-07 21:09:43+00:00</td>
      <td>en</td>
      <td>You were coughing when you hit my weed, but I’...</td>
      <td>coughing hit weed ive never seen feel free</td>
      <td>cough hit weed ve see feel free</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 6 columns</p>
</div>
</div>
</div>
<p>We can clearly see that some stop words in the original text has been removed and some words has been changed. For example, the word ‘called’ in second rows of the clean_text has been changed as ‘call’. By doing Lemmatization, we can improve the accuracy of the word counts therefore the accuracy of the model will be improved as well.</p>
</section>
</section>
<section id="count-vectorizer" class="level2">
<h2 class="anchored" data-anchor-id="count-vectorizer">Count Vectorizer</h2>
<p>CountVectorizer is a great tool provided by the scikit-learn library in Python. It is used to transform a given text into a vector on the basis of the frequency (count) of each word that occurs in the entire text. This is helpful when we have multiple such texts, and we wish to convert each word in each text into vectors (for using in further text analysis). CountVectorizer essentially builds a vocabulary from all the available documents and assigns a unique integer ID to each word. The algorithm then counts the number of times each word appears in each document, and finally assigns a normalized tf-idf score to each word. CountVectorizer is therefore a powerful tool that can be used to convert texts into vectors, which can then be used in various downstream tasks such as machine learning or text analysis.</p>
<div class="cell" data-execution_count="19">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># VERCTORIZE</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>vectorizer<span class="op">=</span>CountVectorizer(stop_words<span class="op">=</span><span class="st">'english'</span>,analyzer <span class="op">=</span> <span class="st">'word'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>vv  <span class="op">=</span>  vectorizer.fit_transform(content)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-execution_count="20">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>count_vect_df <span class="op">=</span> pd.DataFrame(vv.todense(), columns<span class="op">=</span>vectorizer.get_feature_names_out())</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>count_vect_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="20">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>aahn</th>
      <th>aaron</th>
      <th>ab</th>
      <th>abc</th>
      <th>ability</th>
      <th>able</th>
      <th>abolished</th>
      <th>abolitionism</th>
      <th>abortion</th>
      <th>abortions</th>
      <th>...</th>
      <th>zealand</th>
      <th>zen</th>
      <th>zero</th>
      <th>zip</th>
      <th>zkittles</th>
      <th>zombie</th>
      <th>zoning</th>
      <th>zoom</th>
      <th>zoomed</th>
      <th>zooties</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 6345 columns</p>
</div>
</div>
</div>
<p>So we successfully transfer 2500 tweets into words matrix. Each row represents each tweet since we got 2500 tweet there are 2500 rows as expected. Each columns represents each word among 2500 tweets, and each number in the cells present the word count in corresponding tweet, For example, 0 is in the first row and first column which shows that word ‘aahn’ is not showing up in the first tweet.</p>
</section>
<section id="sentiment-score" class="level2">
<h2 class="anchored" data-anchor-id="sentiment-score">Sentiment Score</h2>
<p>VADER’s SentimentIntensityAnalyzer() takes in a string and returns a dictionary of scores in each of four categories: negative, neutral and positive. Here I am going to use the function called “SentimentIntensityAnalyzer” to analysis the tone of each tweets. For each tweet, we’ll get four values, corresponding to “negative”, “neutral”, “positive” and “compound”. The first three values will be in the range 0 to 1, the last value representing the combination of the first three values will be in the range -1 to 1. If the tone of this tweet represents a like, the compound value will be close to 1, and if the tone of this tweet is a hate, it will be close to -1.</p>
<div class="cell" data-execution_count="21">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate the sore of sentiment</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> score_vibe(text):    </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    score<span class="op">=</span>[]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    sia <span class="op">=</span> SentimentIntensityAnalyzer()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> text:</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>        score.append(sia.polarity_scores(i))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>score<span class="op">=</span>score_vibe(content)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>score_df <span class="op">=</span> pd.DataFrame.from_records(score)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>score_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>neg</th>
      <th>neu</th>
      <th>pos</th>
      <th>compound</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.563</td>
      <td>0.392</td>
      <td>0.045</td>
      <td>-0.9531</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.048</td>
      <td>0.578</td>
      <td>0.374</td>
      <td>0.9184</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.225</td>
      <td>0.775</td>
      <td>0.000</td>
      <td>-0.4404</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.381</td>
      <td>0.500</td>
      <td>0.119</td>
      <td>-0.6369</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2495</th>
      <td>0.000</td>
      <td>0.769</td>
      <td>0.231</td>
      <td>0.4019</td>
    </tr>
    <tr>
      <th>2496</th>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2497</th>
      <td>0.366</td>
      <td>0.568</td>
      <td>0.065</td>
      <td>-0.8625</td>
    </tr>
    <tr>
      <th>2498</th>
      <td>0.000</td>
      <td>1.000</td>
      <td>0.000</td>
      <td>0.0000</td>
    </tr>
    <tr>
      <th>2499</th>
      <td>0.278</td>
      <td>0.722</td>
      <td>0.000</td>
      <td>-0.4023</td>
    </tr>
  </tbody>
</table>
<p>2500 rows × 4 columns</p>
</div>
</div>
</div>
<p>This is the sentiment score for each tweet.</p>
<div class="cell" data-execution_count="22">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>score_df.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="22">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>neg</th>
      <th>neu</th>
      <th>pos</th>
      <th>compound</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>2500.000000</td>
      <td>2500.000000</td>
      <td>2500.000000</td>
      <td>2500.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.098713</td>
      <td>0.746492</td>
      <td>0.154802</td>
      <td>0.093621</td>
    </tr>
    <tr>
      <th>std</th>
      <td>0.143998</td>
      <td>0.212583</td>
      <td>0.176645</td>
      <td>0.435726</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-0.974400</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>0.583000</td>
      <td>0.000000</td>
      <td>-0.090050</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>0.000000</td>
      <td>0.738000</td>
      <td>0.110000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>0.182000</td>
      <td>1.000000</td>
      <td>0.278000</td>
      <td>0.440400</td>
    </tr>
    <tr>
      <th>max</th>
      <td>0.912000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.976400</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<p>Some statistics for the 2500 tweets sentiment scores. <br> As we can see the values from the table, “neutral” has hightest mean comparing the “negative” and “positive” score, which means majority of people have neutral feeling about it <br> Take look at “compound” values, its mean are 0.093621 which close to 0 so we can confirm that most people don’t care about the weed.</p>
<div class="cell" data-execution_count="44">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> plt.figure()</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>f.set_figwidth(<span class="dv">10</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>f.set_figheight(<span class="dv">6</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">'Distribution of the Sentiment Scores'</span>,fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Score of sentiment'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Counts'</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>plt.hist(score_df[[<span class="st">'neg'</span>,<span class="st">'neu'</span>,<span class="st">'pos'</span>]], color<span class="op">=</span>[<span class="st">'r'</span>,<span class="st">'b'</span>,<span class="st">'g'</span>], alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">'Neg'</span>,<span class="st">'Neu'</span>,<span class="st">'Pos'</span>])</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="word_cloud_tone_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<p><br> The histogram provides us more straight forward information. From this histogram, we can see that the orange category occupies a higher score, which means that more people are neutral about cannabis. <br> It actually match the our descriptive statistical table of tone score.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#label the dataset with tone</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>tweet[<span class="st">'tone'</span>]<span class="op">=</span>score_df[<span class="st">'compound'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="open-fda-criminal-rate-data" class="level1">
<h1>Open FDA Criminal Rate Data</h1>
<p>Now let’s analysis numerical data. The plot shown below is the small area estimated crime rate. Based on two different types Alcohol and Drug, there are two different color of point.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>alcohol_drug_df<span class="op">=</span>pd.read_csv(<span class="st">"alcohol_drug_df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>ax<span class="op">=</span>sns.catplot(data<span class="op">=</span>alcohol_drug_df,x<span class="op">=</span><span class="st">'State'</span>,y<span class="op">=</span><span class="st">'small_area_estimate'</span>,hue<span class="op">=</span><span class="st">"type"</span>,height <span class="op">=</span> <span class="dv">8</span>, aspect <span class="op">=</span> <span class="fl">1.25</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(rotation<span class="op">=</span><span class="dv">90</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>ax.set_ylabels(<span class="st">"Crime rate estimate"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>ax.set_xlabels(<span class="st">"State in USA"</span>,fontsize<span class="op">=</span><span class="dv">16</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Crime rate estimate in USA"</span>,fontsize<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="word_cloud_tone_files/figure-html/cell-15-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>From the graph, we can see almost all the blue points are on the top of orange points, which means the crime rate caused by alcohol is much higher than marijuana. Here is the descriptive statistics of crime rate table.</p>
<section id="statics-values-of-dataset" class="level2">
<h2 class="anchored" data-anchor-id="statics-values-of-dataset">Statics values of Dataset</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>alcohol_drug_df.groupby(by<span class="op">=</span><span class="st">"type"</span>).agg({<span class="st">"small_area_estimate"</span>:<span class="st">"mean"</span>,<span class="st">"rate_lower"</span>:<span class="st">'mean'</span>,<span class="st">'rate_upper'</span>:<span class="st">'mean'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>According to this table, we can pretty sure that drinking is more likely to commit crime than smoke marijuana</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>